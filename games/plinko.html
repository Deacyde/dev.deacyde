<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Plinko | Deacyde.com</title>
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --bg: #0a0a0f;
            --surface: #1a1a24;
            --border: #2a2a3a;
            --text: #e4e4ed;
            --text-muted: #9494a8;
            --accent: #6c63ff;
            --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        body { background: var(--bg); color: var(--text); font-family: var(--font); display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
        .game-wrapper { width: 480px; max-width: 100vw; }
        .top-bar { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0; margin-bottom: 0.5rem; }
        .top-bar a { color: var(--text-muted); text-decoration: none; font-size: 0.82rem; }
        .top-bar a:hover { color: var(--text); }
        .top-bar h1 { font-size: 1.1rem; font-weight: 700; letter-spacing: -0.02em; }
        .top-bar h1 span { color: var(--accent); }
        .hud { display: flex; justify-content: space-between; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 0.5rem 1rem; margin-bottom: 0.5rem; font-size: 0.82rem; color: var(--text-muted); }
        .hud strong { color: var(--text); }
        .canvas-container { position: relative; }
        canvas { display: block; border: 1px solid var(--border); border-radius: 8px; background: var(--surface); touch-action: none; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(10,10,15,.88); border-radius: 8px; gap: 1rem; pointer-events: auto; z-index: 10; }
        .overlay.hidden { display: none; }
        .overlay h2 { font-size: 1.6rem; font-weight: 800; }
        .overlay p { color: var(--text-muted); font-size: 0.9rem; }
        .play-btn { padding: 0.75rem 2rem; font-family: var(--font); font-size: 1rem; font-weight: 600; background: var(--accent); color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: transform .2s, box-shadow .2s; }
        .play-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(108,99,255,.4); }
        .final-score { font-size: 3rem; font-weight: 800; color: var(--accent); }
        .controls-hint { text-align: center; color: var(--text-muted); font-size: 0.75rem; margin-top: 0.5rem; }
        .drop-zone { display: flex; justify-content: center; gap: 4px; margin-bottom: 0.5rem; }
        .drop-btn { flex: 1; max-width: 44px; padding: 0.4rem 0; font-family: var(--font); font-size: 0.7rem; font-weight: 600; background: var(--surface); border: 1px solid var(--border); border-radius: 6px; color: var(--text-muted); cursor: pointer; text-align: center; transition: border-color .15s, background .15s; }
        .drop-btn:hover, .drop-btn.active { border-color: var(--accent); color: var(--text); background: #1e1e30; }
        .history { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 0.5rem 0.75rem; margin-top: 0.5rem; max-height: 120px; overflow-y: auto; font-size: 0.75rem; color: var(--text-muted); }
        .history-entry { padding: 0.2rem 0; border-bottom: 1px solid #1a1a2a; display: flex; justify-content: space-between; }
        .history-entry:last-child { border-bottom: none; }
        .rank-1 { color: #ffd700; font-weight: 700; }
        .rank-2 { color: #c0c0c0; font-weight: 700; }
        .rank-3 { color: #cd7f32; font-weight: 700; }
        .rank-top { color: #4ade80; }
        .rank-mid { color: #fbbf24; }
        .rank-low { color: #f87171; }
        @media (max-width: 500px) {
            .game-wrapper { width: 100vw; padding: 0 4px; }
            canvas { border-radius: 4px; }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-wrapper">
        <div class="top-bar">
            <a href="../index.html">&larr; Deacyde.com</a>
            <h1>SEO <span>Plinko</span></h1>
        </div>
        <div class="hud">
            <div>Drops: <strong id="dropsDisplay">10</strong></div>
            <div>Best: <strong id="bestDisplay">â€”</strong></div>
            <div>Avg: <strong id="avgDisplay">â€”</strong></div>
        </div>
        <div class="drop-zone" id="dropZone"></div>
        <div class="canvas-container">
            <canvas id="game" width="480" height="520"></canvas>
            <div class="overlay" id="startOverlay">
                <h2>ðŸŽ¯ SEO Plinko</h2>
                <p>Drop the ball &middot; Land on Rank #1!</p>
                <button class="play-btn" id="startBtn">Play</button>
            </div>
            <div class="overlay hidden" id="gameOverOverlay">
                <h2>Round Over</h2>
                <div class="final-score" id="finalAvg">â€”</div>
                <p>Average Ranking</p>
                <button class="play-btn" id="restartBtn">Play Again</button>
            </div>
        </div>
        <p class="controls-hint">Click a drop slot or click the board to drop &middot; Land on #1 for the best ranking!</p>
        <div class="history" id="history">
            <div style="color:#555;text-align:center;">Drop history will appear here</div>
        </div>
    </div>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

// Layout
const PEG_ROWS = 12;
const PEG_COLS = 11;
const PEG_R = 4;
const BALL_R = 8;
const SLOT_COUNT = 10;
const PEG_START_Y = 60;
const PEG_SPACING_Y = 34;
const PEG_SPACING_X = W / (PEG_COLS + 1);
const SLOT_H = 50;
const SLOT_Y = PEG_START_Y + PEG_ROWS * PEG_SPACING_Y + 10;

// Slots: 1 in center, outward to 10
// For 10 slots: [10, 8, 6, 4, 2, 1, 3, 5, 7, 9]
const SLOT_RANKS = [10, 8, 6, 4, 2, 1, 3, 5, 7, 9];
const SLOT_W = W / SLOT_COUNT;

const SLOT_COLORS = {
    1: '#ffd700',
    2: '#c0c0c0',
    3: '#cd7f32',
    4: '#4ade80',
    5: '#4ade80',
    6: '#fbbf24',
    7: '#fbbf24',
    8: '#f87171',
    9: '#f87171',
    10: '#ef4444'
};

const SEO_LABELS = {
    1: '#1 Featured!',
    2: '#2 Top Spot',
    3: '#3 Podium',
    4: '#4 Above Fold',
    5: '#5 Solid',
    6: '#6 Mid Pack',
    7: '#7 Below Fold',
    8: '#8 Page Bottom',
    9: '#9 Buried',
    10: '#10 Last Spot'
};

// Pegs
const pegs = [];
for (let r = 0; r < PEG_ROWS; r++) {
    const cols = r % 2 === 0 ? PEG_COLS : PEG_COLS - 1;
    const offsetX = r % 2 === 0 ? PEG_SPACING_X : PEG_SPACING_X * 1.5;
    for (let c = 0; c < cols; c++) {
        pegs.push({ x: offsetX + c * PEG_SPACING_X, y: PEG_START_Y + r * PEG_SPACING_Y });
    }
}

// State
let balls = [];
let drops = 10;
let results = [];
let gameState = 'start'; // start, playing, over
let dropSlot = 5; // default middle

// Particles
let particles = [];

// Drop zone buttons
const dropZone = document.getElementById('dropZone');
for (let i = 0; i < SLOT_COUNT; i++) {
    const btn = document.createElement('button');
    btn.className = 'drop-btn' + (i === 5 ? ' active' : '');
    btn.textContent = (i + 1);
    btn.onclick = () => {
        document.querySelectorAll('.drop-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        dropSlot = i;
        if (gameState === 'playing') dropBall();
    };
    dropZone.appendChild(btn);
}

function dropBall() {
    if (drops <= 0 || balls.some(b => !b.done)) return;
    const x = (dropSlot + 0.5) * (W / SLOT_COUNT) + (Math.random() - 0.5) * 10;
    balls.push({
        x: x, y: 15,
        vx: 0, vy: 0,
        done: false,
        landed: false,
        landRank: null,
        trail: []
    });
    drops--;
    document.getElementById('dropsDisplay').textContent = drops;
}

// Physics
const GRAVITY = 0.25;
const FRICTION = 0.98;
const BOUNCE = 0.6;

function updateBall(b) {
    if (b.done) return;

    b.vy += GRAVITY;
    b.vx *= FRICTION;

    b.x += b.vx;
    b.y += b.vy;

    // Trail
    b.trail.push({ x: b.x, y: b.y, a: 1 });
    if (b.trail.length > 20) b.trail.shift();

    // Peg collisions
    for (const p of pegs) {
        const dx = b.x - p.x;
        const dy = b.y - p.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const minDist = BALL_R + PEG_R;
        if (dist < minDist && dist > 0) {
            const nx = dx / dist, ny = dy / dist;
            b.x = p.x + nx * minDist;
            b.y = p.y + ny * minDist;
            const dot = b.vx * nx + b.vy * ny;
            b.vx -= 2 * dot * nx * BOUNCE;
            b.vy -= 2 * dot * ny * BOUNCE;
            // Add randomness
            b.vx += (Math.random() - 0.5) * 1.5;
            // Particles
            for (let i = 0; i < 3; i++) {
                particles.push({
                    x: p.x, y: p.y,
                    vx: (Math.random() - 0.5) * 3,
                    vy: (Math.random() - 0.5) * 3,
                    life: 20,
                    color: '#6c63ff'
                });
            }
        }
    }

    // Walls
    if (b.x < BALL_R) { b.x = BALL_R; b.vx = Math.abs(b.vx) * BOUNCE; }
    if (b.x > W - BALL_R) { b.x = W - BALL_R; b.vx = -Math.abs(b.vx) * BOUNCE; }

    // Landing
    if (b.y >= SLOT_Y - BALL_R) {
        b.y = SLOT_Y - BALL_R;
        b.vy = 0;
        b.vx = 0;
        b.done = true;

        const slotIdx = Math.min(SLOT_COUNT - 1, Math.max(0, Math.floor(b.x / SLOT_W)));
        b.landRank = SLOT_RANKS[slotIdx];
        b.landed = true;

        // Celebration particles
        const color = SLOT_COLORS[b.landRank];
        const count = b.landRank <= 3 ? 30 : 10;
        for (let i = 0; i < count; i++) {
            const angle = (Math.PI * 2 * i) / count;
            const speed = 2 + Math.random() * 3;
            particles.push({
                x: b.x, y: b.y,
                vx: Math.cos(angle) * speed,
                vy: Math.sin(angle) * speed - 2,
                life: 40 + Math.random() * 20,
                color: color
            });
        }

        results.push(b.landRank);
        addHistory(results.length, b.landRank);
        updateStats();

        if (drops <= 0) {
            setTimeout(() => {
                gameState = 'over';
                const avg = (results.reduce((a, b) => a + b, 0) / results.length).toFixed(1);
                document.getElementById('finalAvg').textContent = '#' + avg;
                document.getElementById('gameOverOverlay').classList.remove('hidden');
            }, 800);
        }
    }
}

function addHistory(num, rank) {
    const hist = document.getElementById('history');
    if (num === 1) hist.innerHTML = '';
    const entry = document.createElement('div');
    entry.className = 'history-entry';
    const rc = rank <= 1 ? 'rank-1' : rank <= 2 ? 'rank-2' : rank <= 3 ? 'rank-3' : rank <= 5 ? 'rank-top' : rank <= 7 ? 'rank-mid' : 'rank-low';
    entry.innerHTML = `<span>Drop #${num}</span><span class="${rc}">${SEO_LABELS[rank]}</span>`;
    hist.prepend(entry);
}

function updateStats() {
    if (results.length === 0) return;
    const best = Math.min(...results);
    const avg = (results.reduce((a, b) => a + b, 0) / results.length).toFixed(1);
    document.getElementById('bestDisplay').textContent = '#' + best;
    document.getElementById('avgDisplay').textContent = '#' + avg;
}

// Rendering
function drawPegs() {
    for (const p of pegs) {
        ctx.beginPath();
        ctx.arc(p.x, p.y, PEG_R, 0, Math.PI * 2);
        ctx.fillStyle = '#3a3a5a';
        ctx.fill();
        ctx.strokeStyle = '#5a5a7a';
        ctx.lineWidth = 1;
        ctx.stroke();
    }
}

function drawSlots() {
    for (let i = 0; i < SLOT_COUNT; i++) {
        const x = i * SLOT_W;
        const rank = SLOT_RANKS[i];
        const color = SLOT_COLORS[rank];

        // Slot background
        ctx.fillStyle = color + '15';
        ctx.fillRect(x + 1, SLOT_Y, SLOT_W - 2, SLOT_H);

        // Dividers
        ctx.strokeStyle = '#2a2a3a';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(x, SLOT_Y);
        ctx.lineTo(x, SLOT_Y + SLOT_H);
        ctx.stroke();

        // Rank number
        ctx.fillStyle = color;
        ctx.font = 'bold 16px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('#' + rank, x + SLOT_W / 2, SLOT_Y + 24);

        // Small label
        ctx.fillStyle = color + '88';
        ctx.font = '9px Inter, sans-serif';
        const labels = { 1: 'RANK 1', 2: 'RANK 2', 3: 'RANK 3', 4: 'TOP 5', 5: 'TOP 5', 6: 'MID', 7: 'MID', 8: 'LOW', 9: 'LOW', 10: 'LAST' };
        ctx.fillText(labels[rank], x + SLOT_W / 2, SLOT_Y + 40);
    }
}

function drawBalls() {
    for (const b of balls) {
        // Trail
        for (let i = 0; i < b.trail.length; i++) {
            const t = b.trail[i];
            const alpha = (i / b.trail.length) * 0.3;
            ctx.beginPath();
            ctx.arc(t.x, t.y, BALL_R * 0.6, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(108, 99, 255, ${alpha})`;
            ctx.fill();
        }

        // Ball
        const grd = ctx.createRadialGradient(b.x - 2, b.y - 2, 1, b.x, b.y, BALL_R);
        if (b.done && b.landRank) {
            const c = SLOT_COLORS[b.landRank];
            grd.addColorStop(0, '#fff');
            grd.addColorStop(0.4, c);
            grd.addColorStop(1, c + '88');
        } else {
            grd.addColorStop(0, '#a5a0ff');
            grd.addColorStop(0.4, '#6c63ff');
            grd.addColorStop(1, '#4a42cc');
        }
        ctx.beginPath();
        ctx.arc(b.x, b.y, BALL_R, 0, Math.PI * 2);
        ctx.fillStyle = grd;
        ctx.fill();

        // Glow
        ctx.shadowColor = b.done ? (SLOT_COLORS[b.landRank] || '#6c63ff') : '#6c63ff';
        ctx.shadowBlur = 12;
        ctx.beginPath();
        ctx.arc(b.x, b.y, BALL_R, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
    }
}

function drawParticles() {
    for (const p of particles) {
        const alpha = p.life / 40;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = p.color + Math.floor(alpha * 255).toString(16).padStart(2, '0');
        ctx.fill();
    }
}

function drawDropIndicator() {
    if (gameState !== 'playing' || balls.some(b => !b.done)) return;
    const x = (dropSlot + 0.5) * (W / SLOT_COUNT);
    ctx.save();
    ctx.globalAlpha = 0.4 + Math.sin(Date.now() * 0.005) * 0.2;
    ctx.beginPath();
    ctx.arc(x, 15, BALL_R, 0, Math.PI * 2);
    ctx.fillStyle = '#6c63ff';
    ctx.fill();
    // Arrow
    ctx.beginPath();
    ctx.moveTo(x, 28);
    ctx.lineTo(x - 5, 22);
    ctx.lineTo(x + 5, 22);
    ctx.closePath();
    ctx.fillStyle = '#6c63ff';
    ctx.fill();
    ctx.restore();
}

function loop() {
    ctx.clearRect(0, 0, W, H);

    drawSlots();
    drawPegs();
    drawDropIndicator();

    for (const b of balls) updateBall(b);
    drawBalls();

    // Update particles
    for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.08;
        p.life--;
        if (p.life <= 0) particles.splice(i, 1);
    }
    drawParticles();

    requestAnimationFrame(loop);
}

// Click on canvas to drop
canvas.addEventListener('click', (e) => {
    if (gameState !== 'playing') return;
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const x = (e.clientX - rect.left) * scaleX;
    const newSlot = Math.min(SLOT_COUNT - 1, Math.max(0, Math.floor(x / SLOT_W)));
    document.querySelectorAll('.drop-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.drop-btn')[newSlot].classList.add('active');
    dropSlot = newSlot;
    dropBall();
});

// Touch
canvas.addEventListener('touchend', (e) => {
    e.preventDefault();
    if (gameState !== 'playing') return;
    const rect = canvas.getBoundingClientRect();
    const scaleX = W / rect.width;
    const touch = e.changedTouches[0];
    const x = (touch.clientX - rect.left) * scaleX;
    const newSlot = Math.min(SLOT_COUNT - 1, Math.max(0, Math.floor(x / SLOT_W)));
    document.querySelectorAll('.drop-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.drop-btn')[newSlot].classList.add('active');
    dropSlot = newSlot;
    dropBall();
});

function startGame() {
    balls = [];
    results = [];
    particles = [];
    drops = 10;
    gameState = 'playing';
    document.getElementById('dropsDisplay').textContent = drops;
    document.getElementById('bestDisplay').textContent = 'â€”';
    document.getElementById('avgDisplay').textContent = 'â€”';
    document.getElementById('history').innerHTML = '<div style="color:#555;text-align:center;">Drop history will appear here</div>';
    document.getElementById('startOverlay').classList.add('hidden');
    document.getElementById('gameOverOverlay').classList.add('hidden');
}

document.getElementById('startBtn').onclick = startGame;
document.getElementById('restartBtn').onclick = startGame;

// Responsive canvas
function resize() {
    const wrap = document.querySelector('.game-wrapper');
    const maxW = Math.min(480, wrap.clientWidth);
    canvas.style.width = maxW + 'px';
    canvas.style.height = (maxW * H / W) + 'px';
}
window.addEventListener('resize', resize);
resize();

loop();
</script>
</body>
</html>
